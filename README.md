# 🔐 GLiTCH: Leakage Evaluation Framework for Cryptographic Hardware

This repository provides a lightweight framework to evaluate side-channel leakage in unmasked cryptographic S-Box designs. It uses simulation traces (VCDs) generated via Verilog simulation (e.g., using `iverilog`) and performs automated leakage analysis using known input data.

GLiTCH enables a systematic way to explore how signal transitions reveal secret-dependent information, especially in the context of secure hardware design.

---

## 🧩 Overview

The toolchain consists of two main scripts:

1. **`unmasked_aes_sbox.sh`**  
   Automates Verilog simulations across multiple inputs and generates switching activity traces (VCDs) for each run.

2. **`analyze_leaks.py`**  
   Analyzes the generated traces using side-channel metrics like Guessing Entropy (GE) by correlating them with known input values.

---

## 📁 Directory Structure

```
.
├── unmasked_aes_sbox.sh          # Verilog simulation driver (bash)
├── analyze_leaks.py              # Leakage analysis script (Python)
├── clean.sh                      # Utility to remove temporary files
├── verilog_files/                # Folder with Verilog designs and testbenches
├── sboxes/aes/                   # Folder for storing input VCDs and txtfile.txt
├── vcd/                          # Output directory for VCD traces
├── txtfile.txt                   # Plaintext input oracle (generated)
├── output_processing/            # Post-analysis result handling
└── README.md                     # This file
```

---

## 🧪 Verilog Simulation: `unmasked_aes_sbox.sh`

This script performs multiple Verilog simulations for an S-Box design. For each simulation, it injects a new plaintext, uses a fixed key, and generates a corresponding VCD file.

### ✅ Usage

```bash
./unmasked_aes_sbox.sh <verilog_dir> <testbench_file> <num_iterations> <KEY>
```

### ✅ Arguments

| Argument           | Description                                                 |
|--------------------|-------------------------------------------------------------|
| `<verilog_dir>`    | Path to folder containing Verilog source files              |
| `<testbench_file>` | Top-level testbench file inside the given directory         |
| `<num_iterations>` | Number of simulations to perform (e.g., 256)                |
| `<KEY>`            | Constant key to be used during all simulations              |

### ✅ Example

```bash
./unmasked_aes_sbox.sh verilog_files/Unmasked_Sbox_AES tb_unmasked_aes_sbox.v 256 42
```

### 🔍 What It Does

- Injects input values (e.g., plaintexts) using Verilog `\`define` macros
- Runs Icarus Verilog (`iverilog + vvp`) to simulate the design
- Dumps activity traces in standard `.vcd` format (e.g., `0.vcd`, `1.vcd`, ...)
- Saves corresponding inputs to `txtfile.txt`
- Automatically calls `analyze_leaks.py` for leakage evaluation
- Cleans up all temporary simulation artifacts

### 💡 Notes

- The script assumes signal injection and VCD configuration happen at fixed line numbers (customizable inside the script).
- You may replace `iverilog` with any other simulator that produces VCDs.

---

## 📊 Leakage Analysis: `analyze_leaks.py`

This Python script performs post-simulation leakage analysis by correlating signal transitions in VCD files with their corresponding input values. It calculates metrics like **Guessing Entropy (GE)** and can process designs in parallel using multithreading.

### ✅ Usage

```bash
python3 analyze_leaks.py <KEY> <RESULTS_FOLDER> -n <NUM_TRACES> -r <LEAKS_FOLDER> -p <NUM_THREADS>
```

### ✅ Arguments

| Argument             | Description                                              |
|----------------------|----------------------------------------------------------|
| `<KEY>`              | Constant key used during simulation                      |
| `<RESULTS_FOLDER>`   | Prefix for the output files generated by analysis        |
| `-n <NUM_TRACES>`    | Number of VCD traces (must match lines in `txtfile.txt`) |
| `-r <LEAKS_FOLDER>`  | Folder containing `txtfile.txt` and all `.vcd` files     |
| `-p <NUM_THREADS>`   | Number of threads for parallel processing                |

### ✅ Example

```bash
python3 analyze_leaks.py 100 "FN_unmasked_aes_key_100" -n 256 -r sboxes/aes -p 32
```

### 📤 Output

- Leakage metrics such as:
  - **Guessing Entropy (GE)**
  - Possibly Correlation Power Analysis (CPA) scores
- Processed output stored inside `output_processing/sboxes/aes/`
- Intermediate and final results saved using the given prefix (`RESULTS_FOLDER`)

---

## 🧼 Cleanup

To remove temporary build artifacts (dumpfiles, VCDs, intermediate files):

```bash
./clean.sh
```

---

## 🧪 Running Only the Oracle Generator (Optional)

To generate `txtfile.txt` with a fixed set of plaintexts (e.g., 0–255) without simulation:

```bash
./clean.sh
for ((i=0; i<=255; i++)); do
  echo "$i" >> txtfile.txt
done
echo "txtfile.txt created successfully."
```

---

## 🧑‍💻 Maintainers

- **Rohin Menon**  
  [GitHub @RohinMenon](https://github.com/RohinMenon)

---

## 📘 License

This repository is provided for academic and research use only. Please cite the authors if you use it in your work.

---